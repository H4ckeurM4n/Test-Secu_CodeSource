1. Plages horaires inhabituelles (logons, activités, exécutions)

Objectif : Identifier des connexions ou actions en dehors des horaires de bureau (ex : nuit, week-end)

À récupérer sur ELK :
	•	Champ de date/heure : @timestamp
	•	Type de logon : winlog.event_data.LogonType
	•	Nom d’utilisateur : user.name
	•	Nom de machine : host.name
	•	Code événement : 4624 (logon réussi), 4625 (échec)

Visualisations utiles :
	•	Histogrammes par heure de la journée.
	•	Camemberts ou barres par jour de la semaine.
	•	Tableau croisé : user.name × @timestamp (avec filtrage sur heures “hors-norme”).

⸻

2. Extractions de fichiers (volume ou périphériques USB)

Objectif : Détecter les usages anormaux de périphériques externes ou de transferts massifs de fichiers.

À vérifier dans ELK :

A. Pour les périphériques USB
	•	Sources :
	•	Event ID 20001, 2100, 1006, 43, 400 selon les systèmes.
	•	Fournisseur : Microsoft-Windows-DriverFrameworks-UserMode ou Microsoft-Windows-Partition
	•	Champs intéressants :
	•	winlog.event_data.DeviceDescription
	•	winlog.event_data.VID
	•	winlog.event_data.PNPDeviceID
	•	user.name
	•	host.name
	•	@timestamp

B. Pour les copies de fichiers
	•	Sources :
	•	Event ID 4663 (Object Access → Audit de fichiers) — nécessite audit activé.
	•	Champs à observer :
	•	winlog.event_data.ObjectName (chemin fichier copié)
	•	winlog.event_data.AccessMask
	•	winlog.event_data.ShareName
	•	process.name / process.command_line
	•	Taille du fichier (si dispo)

C. Pour les volumes élevés de logs ou transferts :
	•	Si logs proxy ou réseau présents :
	•	bytes_sent, bytes_received, url, user.name
	•	Filtrage par extension: .zip, .rar, .7z, .db, etc.
