Analyse des Dashboards existants

Lâ€™objectif de cette Ã©tape Ã©tait de prendre connaissance des dashboards utilisÃ©s dans lâ€™environnement du SOC Vert, de comprendre leur logique de conception, puis de tenter leur reproduction dans lâ€™environnement ZTD (instance R), en fonction des donnÃ©es disponibles.

â¸»

âœ… Dashboards reproduits avec succÃ¨s (partiellement ou totalement)

â¸»

1. AppLocker

ğŸ¯ Objectif :
Surveiller les blocages dâ€™exÃ©cution de fichiers (.exe, .msi, .dll) liÃ©s Ã  la stratÃ©gie AppLocker, afin de dÃ©tecter dâ€™Ã©ventuels comportements malveillants ou non conformes.

ğŸ”‘ Champs exploitÃ©s :
	â€¢	winlog.event_id : 8002 Ã  8007 (Ã©vÃ©nements AppLocker)
	â€¢	winlog.user_data.FilePath : chemin du fichier exÃ©cutÃ©
	â€¢	host.name : machine concernÃ©e

ğŸ“Š Visualisations mises en place :
	â€¢	Graphique temporel reprÃ©sentant lâ€™Ã©volution du nombre dâ€™Ã©vÃ©nements par type (8002â€“8007).
	â€¢	Camembert des hÃ´tes les plus frÃ©quemment concernÃ©s.
	â€¢	Tableaux listant les fichiers exÃ©cutÃ©s (FilePath) et leur validitÃ©.
	â€¢	Graphiques distinguant les exÃ©cutions valides / invalides.
	â€¢	Indicateurs de blocage : focus sur les fichiers bloquÃ©s (event_id spÃ©cifique).

âš ï¸ Limites rencontrÃ©es :
	â€¢	Le champ FileHash, utilisÃ© dans la visualisation croisÃ©e FilePath â†” FileHash, nâ€™est pas disponible sur R. Visualisation non reproductible.
	â€¢	Dâ€™autres visualisations ont Ã©tÃ© Ã©cartÃ©es si elles reposaient sur des logs absents ou des Ã©lÃ©ments redondants.

â¸»

2. User Logon

ğŸ¯ Objectif :
Assurer le suivi des authentifications utilisateurs : connexions rÃ©ussies et Ã©chouÃ©es, types de logon, utilisateurs suspects, pics dâ€™activitÃ©.

ğŸ”‘ Champs exploitÃ©s :
	â€¢	event.code : 4624 (logon rÃ©ussi), 4625 (Ã©chec)
	â€¢	winlog.event_data.LogonType : type de connexion (interactive, rÃ©seau, etc.)
	â€¢	user.name, winlog.computer_name

ğŸ“Š Visualisations mises en place :
	â€¢	Graphique de tendance des succÃ¨s / Ã©checs de logon.
	â€¢	Tableaux rÃ©capitulatifs pour :
	â€¢	Logon de type 3 (connexion rÃ©seau)
	â€¢	Logon interactif (type 2)
	â€¢	Filtrage des connexions administrateur :
	â€¢	Exclusion des comptes de service, comptes systÃ¨me, etc.
	â€¢	Focus sur comptes SYS-T*, Administrator, ansible
	â€¢	Tableaux des tentatives dâ€™accÃ¨s invalides :
	â€¢	Analyse combinÃ©e des utilisateurs, machines, types de logon, etc.

âš ï¸ Limites rencontrÃ©es :
	â€¢	Types de logon 11 (Cached Auth) et 7 (Unlock) non disponibles sur R : certains tableaux sont donc incomplets.

â¸»

3. Admin Follow

ğŸ¯ Objectif :
Suivre les activitÃ©s spÃ©cifiques des administrateurs, notamment les connexions et les exÃ©cutions de programmes (Ã©levÃ©es ou non).

ğŸ”‘ Champs exploitÃ©s :
	â€¢	event.code : 4624 / 4625 (logon), 4688 (exÃ©cution de processus)
	â€¢	winlog.event_data.TokenElevationType : exÃ©cution avec Ã©lÃ©vation de privilÃ¨ges
	â€¢	user.name, host.name, process.executable

ğŸ“Š Visualisations mises en place :
	â€¢	Graphique du volume de connexions (valides/invalides) pour les comptes SYS-T2-*.
	â€¢	Tableaux dâ€™authentification des administrateurs :
	â€¢	Tous les logons
	â€¢	Logons Ã©chouÃ©s
	â€¢	Visualisation des programmes exÃ©cutÃ©s :
	â€¢	ExÃ©cutions classiques
	â€¢	ExÃ©cutions avec Ã©lÃ©vation (TokenElevationType : "%%1937")

â¸»

âŒ Dashboard non reproductible

User Report

ğŸ“‰ Raisons de lâ€™impossibilitÃ© de reproduction :
	â€¢	Index absent sur R : le dashboard repose sur lâ€™index ansible-ad-users, inexistant sur lâ€™environnement ZTD.
	â€¢	Champs essentiels manquants : par exemple LastLogon.keyword, utilisÃ© dans les visualisations.
	â€¢	ComplexitÃ© de mise en Å“uvre : nÃ©cessiterait des enrichissements non disponibles sur R (parsing, ingestion ADâ€¦).

â¸»

ğŸ“Š Ã‰tat des logs dans la ZTD (instance R)

â¸»

ğŸ”¹ Logs disponibles :
	â€¢	Index : winlogbeat-* (logs Windows classiques collectÃ©s)
	â€¢	Ã‰vÃ©nements collectÃ©s :
	â€¢	Authentifications : 4624, 4625
	â€¢	ExÃ©cutions de processus : 4688
	â€¢	AppLocker partiel : 8002 Ã  8007

â¸»

ğŸ”¸ DonnÃ©es manquantes :
	â€¢	Index absents :
	â€¢	ansible-ad-users (indispensable pour certains dashboards orientÃ©s AD)
	â€¢	Champs non collectÃ©s ou non parsÃ©s :
	â€¢	FileHash, LastLogon, winlog.event_data.LogonType dÃ©taillÃ© (11, 7, etc.)
	â€¢	Pipelines incomplets :
	â€¢	Parsing des Ã©vÃ©nements AppLocker non optimisÃ©
	â€¢	Absence dâ€™enrichissement AD
	â€¢	DonnÃ©es non injectÃ©es :
	â€¢	Informations sur les comptes Active Directory (ex. : date de dernier logon)
