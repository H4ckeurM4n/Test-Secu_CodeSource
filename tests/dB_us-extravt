

Ajouts pour le Dashboard USB : Visualisations sur les extractions de fichiers

9. Tentatives d’accès à des fichiers (Event ID 4663)

Objectif :
Afficher toutes les opérations d’accès (lecture, écriture, suppression) sur des fichiers, notamment juste après un branchement USB.

Requête KQL :

winlog.event_id: 4663 AND winlog.event_data.AccessMask: ("0x2" OR "0x100" OR "0x80")

	•	0x2 = Write
	•	0x100 = Read
	•	0x80 = Delete

Champs clés :
	•	winlog.event_data.ObjectName (nom du fichier)
	•	user.name
	•	host.name
	•	process.name
	•	@timestamp

Visualisation suggérée :
	•	Tableau listant fichiers accédés par utilisateur, avec l’heure
	•	Graphique temporel du volume d’accès

⸻

10. Détection de lecture/copie de fichiers sensibles

Objectif :
Cibler les accès à des fichiers à contenu potentiellement critique : .docx, .xls, .pdf, .db, etc.

Requête KQL :

winlog.event_id: 4663 AND winlog.event_data.ObjectName: (*.xls OR *.pdf OR *.db OR *.docx)

Visualisation suggérée :
	•	Barres empilées : types de fichiers par utilisateur
	•	Camembert : types de fichiers consultés

⸻

11. Corrélation “Branchement USB → Accès fichier” (manuelle ou par visualisation juxtaposée)

Objectif :
Identifier si un accès à fichier sensible survient juste après un event_id:6416 (USB branché).

Méthode (2 façons) :

A. Juxtaposition temporelle :
	•	Deux histogrammes :
	1.	Nombre de 6416 par minute
	2.	Nombre de 4663 dans les minutes suivantes
	•	Repérage visuel des corrélations (pics alignés)

B. Création d’un filtre temporel ciblé :
	•	Filtrer les 4663 sur les 5 minutes après un 6416
(nécessite scripts ou pipeline pour automatiser cela)

⸻

12. Tentatives de transfert vers répertoires externes

Objectif :
Surveiller les chemins de copie vers disques externes (E:\, F:\, etc.).

Requête KQL :

winlog.event_id: 4663 AND winlog.event_data.ObjectName: ("E:\*" OR "F:\*" OR "G:\*")

Visualisation suggérée :
	•	Tableau des fichiers copiés vers ces emplacements
	•	Graphique des utilisateurs ayant accédé le plus ces répertoires

⸻

13. Histogramme des copies de fichiers par heure

Objectif :
Identifier des pics d’activité anormale (surtout en horaires non ouvrés).

Visualisation :
	•	Histogramme temporel avec filtre :

winlog.event_id: 4663 AND winlog.event_data.AccessMask: "0x2"

(écriture)

⸻

Bonus (si process logging actif : event ID 4688)

14. Lancement de process type robocopy / powershell / xcopy

Objectif :
Identifier des outils de copie automatisée utilisés avec une clé USB.

Requête KQL :

event.code: 4688 AND process.name: ("xcopy.exe" OR "robocopy.exe" OR "powershell.exe")

Visualisation :
	•	Tableau avec process.command_line, user.name, host.name, @timestamp

⸻
